<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>30-Day Average FX Converter</title>
<style>
    body {
        font-family: Arial, sans-serif;
        max-width: 500px;
        margin: 2rem auto;
        background-color: #1e1e1e;
        color: #fff;
    }
    h2 {
        text-align: center;
        color: #fff;
    }
    label { 
        display: block; 
        margin-top: 1rem; 
    }
    select, input, button {
        padding: 0.5rem; 
        font-size: 1rem;
    }
    /* Dropdown styling for Windows */
    select {
        background-color: #333;
        color: #fff;
        border: 1px solid #555;
        padding: 0.5rem;
        font-size: 1rem;
    }
    select option {
        background-color: #333;
        color: #fff;
    }
    /* Button styling */
    button {
        background-color: #444;
        color: #fff;
        border: 1px solid #666;
        border-radius: 4px;
        padding: 0.5rem 1rem;
        margin-top: 1rem;
        cursor: pointer;
        transition: background-color 0.2s ease;
    }
    button:hover {
        background-color: #555;
    }
    #result { 
        margin-top: 1.5rem; 
        font-weight: bold; 
        color: #fff;
    }
</style>
</head>
<body>

<h2>30-Day Average Currency Converter</h2>

<label>Amount:
    <input type="number" id="amount" step="0.01" value="100">
</label>

<label>From:
    <select id="from">
        <option value="USD">USD</option>
        <option value="CAD">CAD</option>
        <option value="GBP">GBP</option>
        <option value="AUD">AUD</option>
        <option value="EUR">EUR</option>
        <option value="PHP">PHP</option>
    </select>
</label>

<label>To:
    <select id="to">
        <option value="USD">USD</option>
        <option value="CAD">CAD</option>
        <option value="GBP">GBP</option>
        <option value="AUD">AUD</option>
        <option value="EUR">EUR</option>
        <option value="PHP">PHP</option>
    </select>
</label>

<button id="swap">Swap</button>
<button id="calculate">Calculate</button>

<div id="result"></div>

<script>
async function getAverageRate(from, to) {
    const today = new Date();
    const endDate = today.toISOString().split('T')[0];
    const start = new Date();
    start.setDate(today.getDate() - 30);
    const startDate = start.toISOString().split('T')[0];

    const url = `https://api.frankfurter.app/${startDate}..${endDate}?from=${from}&to=${to}`;
    const res = await fetch(url);
    if (!res.ok) throw new Error("Error fetching exchange rates");

    const data = await res.json();
    const rates = Object.values(data.rates).map(r => r[to]);
    const avgRate = rates.reduce((a, b) => a + b, 0) / rates.length;
    return { avgRate, startDate, endDate };
}

document.getElementById('swap').addEventListener('click', () => {
    const fromSel = document.getElementById('from');
    const toSel = document.getElementById('to');
    [fromSel.value, toSel.value] = [toSel.value, fromSel.value];
});

document.getElementById('calculate').addEventListener('click', async () => {
    const amount = parseFloat(document.getElementById('amount').value);
    const from = document.getElementById('from').value;
    const to = document.getElementById('to').value;
    const resultDiv = document.getElementById('result');

    if (from === to) {
        resultDiv.textContent = `${amount.toFixed(2)} ${to} (same currency)`;
        return;
    }

    try {
        resultDiv.textContent = "Calculating...";
        const { avgRate, startDate, endDate } = await getAverageRate(from, to);
        const converted = amount * avgRate;
        resultDiv.textContent = `${amount.toFixed(2)} ${from} = ${converted.toFixed(2)} ${to}
(Avg rate over ${startDate} to ${endDate}: ${avgRate.toFixed(4)})`;
    } catch (err) {
        resultDiv.textContent = "Error: " + err.message;
    }
});
</script>

</body>
</html>

